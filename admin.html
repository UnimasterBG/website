<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>УниМастер - Админ панел</title>
    <!-- CDN библиотеки -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .admin-header {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 20px 0;
        }
        .tab-content {
            min-height: 500px;
        }
        .reference-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            background: #f8f9fa;
        }
        .gallery-preview {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 5px;
        }
        .drop-zone {
            border: 3px dashed #3498db;
            border-radius: 10px;
            padding: 50px;
            text-align: center;
            background: #f8f9fa;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .drop-zone:hover {
            background: #e9ecef;
            border-color: #2980b9;
        }
        .drop-zone.dragover {
            background: #d4edda;
            border-color: #28a745;
        }
        .json-output {
            background: #2c3e50;
            color: #ecf0f1;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
        .login-container {
            max-width: 400px;
            margin: 100px auto;
        }
        .stats-card {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }
        .nav-pills .nav-link {
            border-radius: 0.375rem;
            margin-right: 10px;
            color: #6c757d;
        }
        .nav-pills .nav-link.active {
            background-color: #3498db;
            color: white;
        }
        .tab-pane {
            display: none;
        }
        .tab-pane.active {
            display: block;
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div id="login-screen" class="login-container">
        <div class="card">
            <div class="card-header text-center">
                <h3><i class="fas fa-user-shield me-2"></i>Админ вход</h3>
            </div>
            <div class="card-body">
                <form id="login-form">
                    <div class="form-group mb-3">
                        <input type="password" class="form-control" id="admin-password" placeholder="Парола" required>
                    </div>
                    <button type="submit" class="btn btn-primary w-100">Влез</button>
                </form>
                <div id="login-error" class="alert alert-danger mt-3" style="display: none;">
                    Грешна парола!
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Panel -->
    <div id="admin-panel" style="display: none;">
        <!-- Header -->
        <div class="admin-header">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col">
                        <h1><i class="fas fa-cogs me-2"></i>УниМастер - Админ панел</h1>
                        <p class="mb-0">Управление на съдържанието на сайта</p>
                    </div>
                    <div class="col-auto">
                        <button class="btn btn-light" onclick="logout()">
                            <i class="fas fa-sign-out-alt me-1"></i>Изход
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="container mt-4">
            <!-- Statistics -->
            <div class="row mb-4">
                <div class="col-md-3">
                    <div class="stats-card">
                        <h3 id="stats-references">0</h3>
                        <p class="mb-0">Референции</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card" style="background: linear-gradient(135deg, #2ecc71, #27ae60);">
                        <h3 id="stats-gallery">0</h3>
                        <p class="mb-0">Снимки</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card" style="background: linear-gradient(135deg, #e67e22, #d35400);">
                        <h3 id="stats-categories">5</h3>
                        <p class="mb-0">Категории</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card" style="background: linear-gradient(135deg, #e74c3c, #c0392b);">
                        <h3 id="last-update">-</h3>
                        <p class="mb-0">Последна промяна</p>
                    </div>
                </div>
            </div>

            <!-- Navigation Tabs -->
            <ul class="nav nav-pills mb-4" role="tablist">
                <li class="nav-item">
                    <button class="nav-link active" onclick="showTab('references-tab')">
                        <i class="fas fa-users me-2"></i>Референции
                    </button>
                </li>
                <li class="nav-item">
                    <button class="nav-link" onclick="showTab('gallery-tab')">
                        <i class="fas fa-images me-2"></i>Галерия
                    </button>
                </li>
                <li class="nav-item">
                    <button class="nav-link" onclick="showTab('export-tab')">
                        <i class="fas fa-download me-2"></i>Експорт
                    </button>
                </li>
            </ul>

            <!-- Tab Content -->
            <div class="tab-content">
                <!-- References Tab -->
                <div class="tab-pane active" id="references-tab">
                    <div class="row">
                        <div class="col-lg-5">
                            <div class="card">
                                <div class="card-header">
                                    <h5><i class="fas fa-plus me-2"></i>Добави референция</h5>
                                </div>
                                <div class="card-body">
                                    <form id="reference-form">
                                        <div class="form-group mb-3">
                                            <label>Име на клиента</label>
                                            <input type="text" class="form-control" id="ref-name" required>
                                        </div>
                                        <div class="form-group mb-3">
                                            <label>Телефон</label>
                                            <input type="tel" class="form-control" id="ref-phone" placeholder="+359888123456" required>
                                        </div>
                                        <div class="form-group mb-3">
                                            <label>Фирма/Обект</label>
                                            <input type="text" class="form-control" id="ref-company" required>
                                        </div>
                                        <div class="form-group mb-3">
                                            <label>Услуга</label>
                                            <input type="text" class="form-control" id="ref-service" required>
                                        </div>
                                        <div class="form-group mb-3">
                                            <label>Отзив</label>
                                            <textarea class="form-control" id="ref-testimonial" rows="3" required></textarea>
                                        </div>
                                        <div class="form-group mb-3">
                                            <label>Категория</label>
                                            <select class="form-control" id="ref-category" required>
                                                <option value="grub-stroej">Груб строеж</option>
                                                <option value="dovarshitelni">Довършителни</option>
                                                <option value="tehnika">Техника</option>
                                                <option value="gotovi">Готови обекти</option>
                                                <option value="proekti">Проекти</option>
                                            </select>
                                        </div>
                                        <button type="submit" class="btn btn-primary w-100">
                                            <i class="fas fa-save me-2"></i>Запази
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-7">
                            <div class="card">
                                <div class="card-header">
                                    <h5><i class="fas fa-list me-2"></i>Списък с референции</h5>
                                </div>
                                <div class="card-body" style="max-height: 600px; overflow-y: auto;">
                                    <div id="references-list"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Gallery Tab -->
                <div class="tab-pane" id="gallery-tab">
                    <div class="row">
                        <div class="col-lg-5">
                            <div class="card">
                                <div class="card-header">
                                    <h5><i class="fas fa-upload me-2"></i>Добави снимка</h5>
                                </div>
                                <div class="card-body">
                                    <!-- Drag & Drop Zone -->
                                    <div class="drop-zone" id="drop-zone">
                                        <i class="fas fa-cloud-upload-alt fa-3x mb-3"></i>
                                        <p>Плъзни снимки тук или кликни за избор</p>
                                        <input type="file" id="file-input" multiple accept="image/*" style="display: none;">
                                    </div>
                                    
                                    <form id="gallery-form" class="mt-3">
                                        <div class="form-group mb-3">
                                            <label>Заглавие</label>
                                            <input type="text" class="form-control" id="img-title" required>
                                        </div>
                                        <div class="form-group mb-3">
                                            <label>Категория</label>
                                            <select class="form-control" id="img-category" required>
                                                <option value="grub">Груб строеж</option>
                                                <option value="dovar">Довършителни</option>
                                                <option value="tech">Техника</option>
                                                <option value="ready">Готови</option>
                                                <option value="proj">Проекти</option>
                                            </select>
                                        </div>
                                        <div class="form-group mb-3">
                                            <label>Alt текст</label>
                                            <input type="text" class="form-control" id="img-alt">
                                        </div>
                                        <button type="submit" class="btn btn-success w-100" disabled id="add-to-gallery">
                                            <i class="fas fa-plus me-2"></i>Добави в галерията
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-7">
                            <div class="card">
                                <div class="card-header">
                                    <h5><i class="fas fa-images me-2"></i>Галерия снимки</h5>
                                </div>
                                <div class="card-body" style="max-height: 600px; overflow-y: auto;">
                                    <div id="gallery-list" class="row"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Export Tab -->
<div class="tab-pane" id="export-tab">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5><i class="fas fa-code me-2"></i>Експорт на данни</h5>
                </div>
                <div class="card-body">
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        Генериран код за <strong>добавяне</strong> към съществуващия <code>js/data-config.js</code> файл.
                    </div>
                    
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <h6>Основни действия:</h6>
                            <button class="btn btn-primary me-2 mb-2" onclick="generateJSON()">
                                <i class="fas fa-sync me-1"></i>Генерирай код за добавяне
                            </button>
                            <button class="btn btn-success me-2 mb-2" onclick="copyToClipboard()">
                                <i class="fas fa-copy me-1"></i>Копирай в clipboard
                            </button>
                            <button class="btn btn-warning mb-2" onclick="downloadJSON()">
                                <i class="fas fa-download me-1"></i>Изтегли файл
                            </button>
                        </div>
                        <div class="col-md-6">
                            <h6>Управление на данни:</h6>
                            <button class="btn btn-outline-primary me-2 mb-2" onclick="exportOnlyNew()">
                                <i class="fas fa-plus-circle me-1"></i>Само нови данни
                            </button>
                            <button class="btn btn-outline-secondary me-2 mb-2" onclick="importExistingData()">
                                <i class="fas fa-upload me-1"></i>Импорт
                            </button>
                            <button class="btn btn-outline-danger mb-2" onclick="clearAllData()">
                                <i class="fas fa-trash me-1"></i>Изчисти всичко
                            </button>
                        </div>
                    </div>
                    
                    <textarea id="json-output" class="form-control json-output" rows="25" readonly placeholder="Натисни 'Генерирай код за добавяне' за да видиш инструкциите..."></textarea>
                    
                    <div class="alert alert-warning mt-3">
                        <strong>Стъпки за добавяне:</strong><br>
                        1. Натисни "Генерирай код за добавяне"<br>
                        2. Копирай кода от текстовото поле<br>
                        3. Отвори <code>js/data-config.js</code> в редактор<br>
                        4. Добави новите обекти в съответните масиви<br>
                        5. Запази и push в GitHub<br>
                        6. Опционално: изчисти админ панела
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


    <!-- JAVASCRIPT -->
    <script>
        // ADMIN PANEL JAVASCRIPT - РАБОТЕЩА ВЕРСИЯ

        // Парола за достъп (промени я!)
        const ADMIN_PASSWORD = 'unimaster2025';

        // Данни
        let references = [];
        let gallery = [];
        let selectedFile = null;

        // Инициализация
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Admin panel loaded');
            
            loadFromStorage();
            updateStats();
            
            // Login form
            document.getElementById('login-form').addEventListener('submit', function(e) {
                e.preventDefault();
                const password = document.getElementById('admin-password').value;
                if (password === ADMIN_PASSWORD) {
                    document.getElementById('login-screen').style.display = 'none';
                    document.getElementById('admin-panel').style.display = 'block';
                    document.getElementById('login-error').style.display = 'none';
                    console.log('Login successful');
                } else {
                    document.getElementById('login-error').style.display = 'block';
                }
            });
            
            // Reference form
            document.getElementById('reference-form').addEventListener('submit', function(e) {
                e.preventDefault();
                addReference();
            });
            
            // Gallery form
            document.getElementById('gallery-form').addEventListener('submit', function(e) {
                e.preventDefault();
                addToGallery();
            });
            
            // File input
            document.getElementById('file-input').addEventListener('change', handleFileSelect);
            document.getElementById('drop-zone').addEventListener('click', () => {
                document.getElementById('file-input').click();
            });
            
            // Drag & Drop
            const dropZone = document.getElementById('drop-zone');
            dropZone.addEventListener('dragover', handleDragOver);
            dropZone.addEventListener('drop', handleFileDrop);
            dropZone.addEventListener('dragleave', function(e) {
                e.preventDefault();
                this.classList.remove('dragover');
            });
        });

        // Tab switching
        function showTab(tabId) {
            // Скрий всички табове
            document.querySelectorAll('.tab-pane').forEach(pane => {
                pane.classList.remove('active');
            });
            
            // Премахни активен клас от всички бутони
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            // Покажи избрания таб
            document.getElementById(tabId).classList.add('active');
            
            // Добави активен клас на бутона
            event.target.classList.add('active');
            
            console.log('Tab switched to:', tabId);
        }

        // Login/Logout
        function logout() {
            document.getElementById('login-screen').style.display = 'block';
            document.getElementById('admin-panel').style.display = 'none';
            document.getElementById('admin-password').value = '';
        }

        // Storage functions
        function saveToStorage() {
            localStorage.setItem('unimaster_references', JSON.stringify(references));
            localStorage.setItem('unimaster_gallery', JSON.stringify(gallery));
            localStorage.setItem('unimaster_last_update', new Date().toLocaleDateString('bg-BG'));
            updateStats();
            console.log('Data saved to storage');
        }

        function loadFromStorage() {
            const savedRefs = localStorage.getItem('unimaster_references');
            const savedGallery = localStorage.getItem('unimaster_gallery');
            
            if (savedRefs) {
                references = JSON.parse(savedRefs);
                console.log('Loaded references:', references.length);
            }
            if (savedGallery) {
                gallery = JSON.parse(savedGallery);
                console.log('Loaded gallery items:', gallery.length);
            }
            
            updateReferencesList();
            updateGalleryList();
        }

        // References functions
        function addReference() {
            const ref = {
                id: Date.now(),
                name: document.getElementById('ref-name').value,
                phone: document.getElementById('ref-phone').value,
                company: document.getElementById('ref-company').value,
                service: document.getElementById('ref-service').value,
                testimonial: document.getElementById('ref-testimonial').value,
                category: document.getElementById('ref-category').value
            };
            
            references.push(ref);
            saveToStorage();
            updateReferencesList();
            document.getElementById('reference-form').reset();
            
            alert('Референцията е добавена успешно!');
        }

        function removeReference(id) {
            if (confirm('Сигурни ли сте, че искате да изтриете тази референция?')) {
                references = references.filter(ref => ref.id !== id);
                saveToStorage();
                updateReferencesList();
            }
        }

        function updateReferencesList() {
            const container = document.getElementById('references-list');
            if (references.length === 0) {
                container.innerHTML = '<p class="text-muted text-center">Няма добавени референции.</p>';
                return;
            }
            
            container.innerHTML = references.map(ref => `
                <div class="reference-card">
                    <div class="d-flex justify-content-between align-items-start">
                        <div class="flex-grow-1">
                            <h6><strong>${ref.name}</strong></h6>
                            <p class="mb-1"><i class="fas fa-building me-1"></i>${ref.company}</p>
                            <p class="mb-1"><i class="fas fa-tools me-1"></i>${ref.service}</p>
                            <p class="mb-1"><i class="fas fa-phone me-1"></i>${ref.phone}</p>
                            <p class="mb-1 text-muted">"${ref.testimonial}"</p>
                            <span class="badge bg-primary">${getCategoryName(ref.category)}</span>
                        </div>
                        <button class="btn btn-sm btn-danger" onclick="removeReference(${ref.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Gallery functions
        function handleFileSelect(e) {
            selectedFile = e.target.files[0];
            if (selectedFile) {
                document.getElementById('add-to-gallery').disabled = false;
                document.getElementById('img-title').value = selectedFile.name.split('.')[0];
                document.getElementById('img-alt').value = selectedFile.name.split('.')[0];
                
                showFilePreview(selectedFile);
            }
        }

        function showFilePreview(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const dropZone = document.getElementById('drop-zone');
                dropZone.innerHTML = `
                    <img src="${e.target.result}" style="max-width: 200px; max-height: 150px; border-radius: 5px;">
                    <p class="mt-2">${file.name}</p>
                    <small class="text-muted">Кликни за промяна</small>
                `;
            };
            reader.readAsDataURL(file);
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.stopPropagation();
            document.getElementById('drop-zone').classList.add('dragover');
        }

        function handleFileDrop(e) {
            e.preventDefault();
            e.stopPropagation();
            document.getElementById('drop-zone').classList.remove('dragover');
            
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                selectedFile = files[0];
                document.getElementById('add-to-gallery').disabled = false;
                document.getElementById('img-title').value = selectedFile.name.split('.')[0];
                document.getElementById('img-alt').value = selectedFile.name.split('.')[0];
                showFilePreview(selectedFile);
            }
        }

        function addToGallery() {
            if (!selectedFile) {
                alert('Моля изберете снимка първо!');
                return;
            }
            
            const filename = `${Date.now()}-${selectedFile.name.replace(/[^a-zA-Z0-9.-]/g, '_')}`;
            
            const item = {
                id: Date.now(),
                filename: filename,
                title: document.getElementById('img-title').value,
                category: document.getElementById('img-category').value,
                alt: document.getElementById('img-alt').value || document.getElementById('img-title').value
            };
            
            gallery.push(item);
            saveToStorage();
            updateGalleryList();
            resetGalleryForm();
            
            alert(`Снимката е добавена!\n\nКачи файла "${filename}" в папка img/ на сървъра.`);
        }

        function resetGalleryForm() {
            document.getElementById('gallery-form').reset();
            document.getElementById('add-to-gallery').disabled = true;
            selectedFile = null;
            
            document.getElementById('drop-zone').innerHTML = `
                <i class="fas fa-cloud-upload-alt fa-3x mb-3"></i>
                <p>Плъзни снимки тук или кликни за избор</p>
            `;
        }

        function removeGalleryItem(id) {
            if (confirm('Сигурни ли сте, че искате да изтриете тази снимка?')) {
                gallery = gallery.filter(item => item.id !== id);
                saveToStorage();
                updateGalleryList();
            }
        }

        function updateGalleryList() {
            const container = document.getElementById('gallery-list');
            if (gallery.length === 0) {
                container.innerHTML = '<div class="col-12"><p class="text-muted text-center">Няма добавени снимки.</p></div>';
                return;
            }
            
            container.innerHTML = gallery.map(item => `
                <div class="col-md-6 col-lg-4 mb-3">
                    <div class="card">
                        <div class="card-body">
                            <h6>${item.title}</h6>
                            <p class="small mb-1"><i class="fas fa-file me-1"></i>${item.filename}</p>
                            <p class="small mb-1"><i class="fas fa-tag me-1"></i>${getCategoryName(item.category)}</p>
                            <p class="small mb-2 text-muted">${item.alt}</p>
                            <button class="btn btn-sm btn-danger" onclick="removeGalleryItem(${item.id})">
                                <i class="fas fa-trash me-1"></i>Изтрий
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Utility functions
        function getCategoryName(category) {
            const names = {
                'grub-stroej': 'Груб строеж',
                'grub': 'Груб строеж',
                'dovarshitelni': 'Довършителни',
                'dovar': 'Довършителни',
                'tehnika': 'Техника',
                'tech': 'Техника',
                'gotovi': 'Готови обекти',
                'ready': 'Готови обекти',
                'proekti': 'Проекти',
                'proj': 'Проекти'
            };
            return names[category] || category;
        }

        function updateStats() {
            document.getElementById('stats-references').textContent = references.length;
            document.getElementById('stats-gallery').textContent = gallery.length;
            const lastUpdate = localStorage.getItem('unimaster_last_update') || 'Никога';
            document.getElementById('last-update').textContent = lastUpdate;
        }

 // Export functions - ПОДОБРЕНА ВЕРСИЯ
function generateJSON() {
    console.log('Generating incremental JSON...');
    
    if (references.length === 0 && gallery.length === 0) {
        alert('Няма нови данни за експорт!');
        return;
    }
    
    let output = `// УниМастер - ДОБАВКИ КЪМ data-config.js
// Копирай и добави към съществуващия файл

`;

    if (references.length > 0) {
        output += `// === НОВИ РЕФЕРЕНЦИИ ===
// Добави тези обекти в масива referencesData:

`;
        references.forEach((ref, index) => {
            output += `    // Референция ${index + 1}
    {
        name: "${ref.name}",
        phone: "${ref.phone}",
        company: "${ref.company}",
        service: "${ref.service}",
        testimonial: "${ref.testimonial}",
        category: "${ref.category}"
    },
`;
        });
        
        output += `
// За добавяне - отвори js/data-config.js и вмъкни горните обекти в referencesData масива
// Пример: 
// const referencesData = [
//     ...съществуващите данни...,
//     ...новите данни от тук...
// ];

`;
    }

    if (gallery.length > 0) {
        output += `// === НОВИ СНИМКИ ===
// Добави тези обекти в масива galleryData:

`;
        gallery.forEach((item, index) => {
            output += `    // Снимка ${index + 1}
    { 
        filename: "${item.filename}", 
        title: "${item.title}", 
        category: "${item.category}", 
        alt: "${item.alt}"
    },
`;
        });
        
        output += `
// За добавяне - отвори js/data-config.js и вмъкни горните обекти в galleryData масива
// НЕ ЗАБРАВЯЙ: Качи снимките в папка img/ със същите имена!

`;
    }

    output += `// === ИНСТРУКЦИИ ===
// 1. Отвори js/data-config.js
// 2. Намери масивите referencesData и galleryData  
// 3. Добави новите обекти в съответните масиви
// 4. Запази файла
// 5. Commit & Push в GitHub
// 6. Изчисти админ панела с бутона по-долу

// === ГОТОВ КОД ЗА КОПИРАНЕ ===
// Ако предпочиташ да заместиш ЦЕЛИЯ файл:

const referencesData = ${JSON.stringify(references.map(ref => ({
    name: ref.name,
    phone: ref.phone,
    company: ref.company,
    service: ref.service,
    testimonial: ref.testimonial,
    category: ref.category
})), null, 4)};

const galleryData = ${JSON.stringify(gallery.map(item => ({
    filename: item.filename,
    title: item.title,
    category: item.category,
    alt: item.alt
})), null, 4)};

window.unimasterData = {
    references: referencesData,
    gallery: galleryData
};`;
    
    document.getElementById('json-output').value = output;
    console.log('Incremental JSON generated successfully');
}


        function copyToClipboard() {
            const textarea = document.getElementById('json-output');
            if (!textarea.value) {
                alert('Първо генерирай JSON кода!');
                return;
            }
            
            textarea.select();
            textarea.setSelectionRange(0, 99999);
            
            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    alert('JSON кодът е копиран в clipboard!');
                } else {
                    throw new Error('Copy command failed');
                }
            } catch (err) {
                // Fallback за модерни браузъри
                if (navigator.clipboard && navigator.clipboard.writeText) {
                    navigator.clipboard.writeText(textarea.value).then(() => {
                        alert('JSON кодът е копиран в clipboard!');
                    }).catch(() => {
                        alert('Копирането не успя. Моля копирайте ръчно текста.');
                    });
                } else {
                    alert('Копирането не успя. Моля копирайте ръчно текста.');
                }
            }
        }

        function downloadJSON() {
            const content = document.getElementById('json-output').value;
            if (!content) {
                alert('Първо генерирай JSON кода!');
                return;
            }
            
            const blob = new Blob([content], { type: 'text/javascript' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'data-config.js';
            a.style.display = 'none';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            console.log('JSON file downloaded');
        }

        console.log('Admin panel script loaded successfully');
    </script>
</body>
</html>
